<html>
	<head>
		<title>This is Assignment-3</title>
		<style>
			#Title {
				background-color: black;
    			color: white;
			}
			.Temp1 {
				font-size: larger;
    			font-weight: bold;
    			padding-bottom: 10px;
			}
			.Temp2{
				border-bottom: 1px solid gray;
    			padding-bottom: 5px;
			}
			ul {
				float: left;
				padding-left: 0;
			}
			li {
				list-style: none;
			}
		</style>
	</head>
	<body>
		<h1 id="Title">Assignment-3</h1>
		
		<ul id="log">
		</ul>
		<svg width="600" height="400">
            <rect width="600" height="400" fill="none" stroke="black" stroke-width="1"></rect>
            <g id="dotGroup"></g>
        </svg>
	</body>

	<script src="https://d3js.org/d3.v3.min.js"></script>
	<script>
		var countries;
		var vizYear = 2008;
		var log = d3.select("#log");
		var count = 0; 

		var dots = d3.select("#dotGroup");
		var width = 600,
			height = 400,
			margin = {top: 10, bottom: 10, left: 10, right: 10},
			innerWidth = width - margin.left - margin.right,
			innerHeight = height - margin.top - margin.bottom;

		var xScale = d3.scale.linear().range([0, innerWidth]),
            yScale = d3.scale.linear().range([innerHeight, 0]),
            populationScale = d3.scale.linear().range([5,25]),
            colorScale = d3.scale.category10();

        dots.attr("transform","translate(" + margin.left + "," + margin.top + ")")

		d3.json("https://raw.githubusercontent.com/CristianFelix/infoviz/master/Week%203/newData.json", function(error, data){
			if(error){
				window.alert("Data Invalid");
			}
			else{
				data = data.filter(function(d) { return d.income[vizYear] != undefined;});
				countries = data;
				render();
			}
		});

		function render(){
			log.selectAll("li")
				.data(countries)
				.enter()
				.append("li")
				.text(country => country.name)

			var dataPoints = dots.selectAll("circle").data(countries);
            
            xScale.domain(d3.extent(countries, function(d) { return d.income[vizYear] }  ));
            yScale.domain(d3.extent(countries, function(d) { return d.lifeExpectancy[vizYear] }  ))
            populationScale.domain(d3.extent(countries, function(d) { return d.population[vizYear] }  ))
            
            dataPoints.enter()
                .append("circle")
                .attr("r", function(d, i) { return populationScale(d.population[vizYear]) })
                .attr("cx", 
                      function(d, i) { return xScale(d.income[vizYear]) })
                .attr("cy", 
                      function(d, i) { return yScale(d.lifeExpectancy[vizYear]) })
                .attr("fill", function(d, i) { return colorScale(d.region) })
                .attr("opacity", 0.65)
		}
	</script>
</html>